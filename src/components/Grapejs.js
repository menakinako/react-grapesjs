import React, {useState, useEffect} from 'react';
import  grapesjs  from 'grapesjs';
import gjsPresetWebPage from 'grapesjs-preset-webpage';
import exportPlugin from 'grapesjs-plugin-export';
import '../../node_modules/grapesjs/dist/css/grapes.min.css';
import '../../node_modules/grapesjs-preset-webpage/dist/grapesjs-preset-webpage.min.css';
import '../styles/main.scss'
import { Button } from '@material-ui/core';
 
const Grapejs=()=>{
    const [editor, setEditor] = useState(null);
    const [html, setHtml] = useState(null);
    const [css, setCss] = useState(null);

  useEffect(()=>{
    const editor = grapesjs.init({
      container:"#editor",
      plugins:[gjsPresetWebPage, 'gjs-blocks-basic', exportPlugin],
      pluginsOpts:{
        gjsPresetWebPage:{},
        exportPlugin:{}
      },
      blockManager:{
     
      },
      assetManager: {
        showUrlInput: true,
        autoAdd: true,
        storeOnChange  : true,
      },
      storageManager: {
        id: 'gjs-',             
        type: 'local',         
        autosave: true,        
        autoload: true,    
        storeHtml: true,   
        storeCss: true,      
        stepsBeforeSave: 1,     
      },
    })
    const blockManager = editor.BlockManager;
    blockManager.add('blog', {
      label: 'Blog',
      content: '<p>Write your blog here</p>',
      media:`<svg width="30px" height="30px" version="1.0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(0 512) scale(.1 -.1)">
      <path d="m335 5066c-150-48-257-166-285-315-15-79-14-3602 1-3673 33-154 158-282 310-317 28-7 339-11 837-11h793l492-352c281-201 504-354 520-356 15-2 41 1 58 9 56 22 59 44 59 388v310l333 3c286 3 338 6 377 21 108 42 199 132 243 239 22 52 22 64 25 671l3 618-35 35c-44 44-83 45-128 5l-33-29-5-614-5-613-24-38c-13-21-42-50-64-65l-41-27-946-10-27-28c-65-64-15-167 82-167h45v-211c0-168-3-209-12-202-7 6-202 144-433 309l-419 299-1684 10-43 30c-23 17-53 50-66 74l-23 44v1809c0 1997-5 1846 63 1916 63 66-38 62 1764 62 1145 0 1647-3 1677-11 56-14 114-62 137-113 17-38 19-75 19-481v-440l-758-760-759-760-81-306c-45-168-82-320-82-338 0-36 34-77 73-86 15-4 142 23 343 75l319 81 1043 1042c1151 1150 1096 1090 1096 1216 0 103-25 146-162 285-140 141-182 166-287 166-116 0-149-22-362-232l-183-182v345c0 286-3 355-16 400-32 109-118 208-222 257l-57 27-1715 2c-1366 1-1723-1-1755-11zm4452-909c127-127 136-148 86-207l-26-32-148 148c-81 81-145 152-142 157 11 17 69 47 93 47 17 0 54-30 137-113zm-227-232 145-145-1800-1800-295 295 897 897c494 494 900 898 903 898s70-65 150-145zm-1858-2026c-9-8-235-69-240-65-3 3 46 184 64 235 3 10 33-14 94-74 49-49 86-92 82-96z"/>
      <path d="m917 4269c-32-18-50-75-37-114 22-66 12-65 495-65h437l29 29c38 39 39 87 3 130l-26 31h-441c-296-1-448-4-460-11z"/>
      <path d="m2136 4249c-36-43-35-91 3-130l29-29h345 344l26 24c33 31 43 68 27 107-25 60-22 59-401 59h-347l-26-31z"/>
      <path d="m3133 4265c-12-8-27-31-33-50-14-43 8-96 46-114 31-14 258-15 285-1 53 29 61 121 12 160-23 18-40 20-157 20-101 0-137-4-153-15z"/>
      <path d="m912 3435c-39-33-48-74-27-115 29-55 61-61 295-58 204 3 209 4 234 27 31 30 42 73 26 112-23 54-47 59-284 59h-214l-30-25z"/>
      <path d="m1688 3431c-44-39-46-98-5-138l27-28h575 575l27 27c41 41 39 100-5 139l-32 29h-565-565l-32-29z"/>
      <path d="m1007 2610c-49-39-41-131 12-160 25-13 287-13 312 0 53 29 61 121 12 160-23 18-40 20-168 20s-145-2-168-20z"/>
      <path d="m1658 2600c-27-28-30-36-25-73 4-28 14-49 32-64 25-22 33-23 231-23 122 0 213 4 225 10 53 29 61 121 12 160-24 19-39 20-235 20h-210l-30-30z"/>
      <path d="m910 1783c-40-37-47-78-20-121 11-18 32-37 46-42 34-13 984-13 1018 0 34 12 60 55 60 98 0 26-8 41-32 63l-32 29h-505-505l-30-27z"/>
      </g>
      </svg>`,
      category: 'Basic',
      attributes: {
        title: 'Insert Blog'
      }
    });
    blockManager.add('courses', {
      label: 'Courses',
      content: '<h3>Your Course</h3>',
      media:`<svg width="30px" height="30px" version="1.0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(0 512) scale(.1 -.1)">
      <path d="m213 5009c-70-27-145-100-180-174l-28-60v-3410l22-47c30-66 105-143 172-175l56-28 892-3 893-2v-43c-1-134-65-292-151-371-83-77-119-87-329-95-169-7-177-8-229-36-87-48-133-126-133-225 0-31 7-74 16-95 22-52 80-112 131-136 38-18 91-19 1215-19s1177 1 1215 19c51 24 109 84 131 136 9 21 16 64 16 95 0 99-46 177-133 225-52 28-60 29-229 36-210 8-246 18-329 95-86 79-150 237-151 371v43l893 2 892 3 56 28c67 32 142 109 172 175l22 47v3410l-33 67c-39 80-102 139-178 168-54 20-66 20-2347 19-2265 0-2293 0-2344-20zm4666-178c18-13 42-42 52-65 18-39 19-97 19-1423v-1383h-170v1330c0 1418 1 1376-45 1394-22 8-4328 8-4350 0-46-18-45 24-45-1394v-1330h-170v1383c0 1326 1 1384 19 1423 17 38 54 73 91 87 8 3 1039 5 2290 4l2275-2 34-24zm-269-1586v-1275h-4100v2550h4100v-1275zm340-1640c0-203-5-229-56-277-16-15-42-32-57-37-20-8-713-11-2278-11-2449 0-2285-4-2341 56-43 47-48 74-48 270v184h4780v-185zm-2046-517c2-13 9-60 16-105 18-131 75-280 135-352l27-31h-1044l27 31c60 72 117 221 135 352 7 45 14 92 16 105l4 22h680l4-22zm794-668c6 0 21-9 32-20 28-28 27-87-2-117l-21-23h-2291l-23 22c-40 37-30 112 17 132 20 8 329 10 1151 9 618-1 1130-2 1137-3z"/>
      <path d="m1800 4004c-404-190-744-354-755-365-25-25-25-83 0-109 11-11 106-60 210-109l190-89 5-320c4-224 9-323 17-333 6-8 255-135 552-284l541-269 541 269c298 149 547 279 555 290 11 16 14 80 14 331v312l107 52c59 28 117 53 130 56l23 6v-590l-85-129c-66-100-85-136-85-164 0-47 33-79 81-79 41 0 63 21 129 118l42 64 53-79c71-106 86-116 147-100 27 7 58 50 58 81 0 8-38 72-85 143l-85 128v774l-22 25c-28 31-1481 716-1518 716-14 0-356-156-760-346zm1255-65c270-127 508-239 530-249 39-18 32-19-447-19l-488-1v43c0 55-28 109-62 121-41 14-80-3-101-44-16-31-17-58-15-223l3-189 28-24c35-30 78-31 112-1 22 18 27 34 32 85l6 62h485c267 0 483-2 481-3-2-2-241-115-531-252l-527-247-448 211c-247 115-524 245-617 288s-169 82-170 86c-1 7 1219 586 1234 587 3 0 226-104 495-231zm-1002-895 417-197v-101c0-76 4-110 18-136 33-66 111-66 144 0 14 26 18 60 18 136v101l418 196c230 109 421 197 425 197s7-102 7-228v-227l-940-470-940 470v227c0 126 3 228 8 228 4 0 195-88 425-196z"/>
      <path d="m2245 1595c-27-27-33-79-12-106 28-36 51-39 327-39s299 3 327 39c21 27 15 79-12 106l-24 25h-582l-24-25z"/>
      </g>
      </svg>`,
      category: 'Basic',
      attributes: {
        title: 'Add Course'
      }
    });
    blockManager.add('webinar', {
      label: 'Webinars',
      content: '<p>Write your blog here</p>',
      media:`<svg width="30px" height="30px" version="1.0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(0 512) scale(.1 -.1)">
      <path d="m441 4864c-169-45-301-180-346-351-23-87-22-2700 0-2788 45-172 179-305 352-350 48-13 173-15 795-15 677 0 738-1 738-16 0-17-36-240-45-281-4-15-13-23-27-23-112 0-228-122-228-240 0-92 80-202 166-228 30-9 181-12 554-12h512l84-63c238-178 529-268 824-253 330 16 606 139 841 375 186 186 301 398 354 651 17 78 24 234 18 410-1 30 1 665 3 1410 3 956 1 1370-7 1408-36 174-178 321-356 367-85 22-4149 21-4232-1zm4255-176c76-40 107-70 145-140l34-63 3-940c1-517 1-1043 0-1170-3-224-3-229-20-198-10 17-45 67-78 111l-60 80v2143l-25 24-24 25h-4222l-24-25-25-24v-2351h-160l2 1163 3 1162 25 50c43 86 125 154 215 176 17 4 959 6 2095 6l2065-2 51-27zm-2376-1408v-1120h-1760v2240h1760v-1120zm1120 600v-520h-158l-4 158c-3 145-5 161-29 212-14 30-42 71-61 90l-34 35 23 50c41 90 26 177-44 255-95 106-236 108-338 5-78-77-95-166-52-260l23-49-34-35c-19-19-46-59-61-90-24-52-26-68-29-213l-4-158h-158v1040h960v-520zm1120 0v-520h-158l-4 158c-3 145-5 161-29 212-14 30-42 71-61 90l-34 35 23 50c41 90 26 177-44 255-95 106-236 108-338 5-78-77-95-166-52-260l23-49-34-35c-19-19-46-59-61-90-24-52-26-68-29-213l-4-158h-158v1040h960v-520zm-1545 175c16-15 25-36 25-55s-9-40-25-55c-15-16-36-25-55-25s-40 9-55 25c-16 15-25 36-25 55s9 40 25 55c15 16 36 25 55 25s40-9 55-25zm1120 0c16-15 25-36 25-55s-9-40-25-55c-15-16-36-25-55-25s-40 9-55 25c-16 15-25 36-25 55s9 40 25 55c15 16 36 25 55 25s40-9 55-25zm-1087-322c62-46 67-62 70-224l3-149h-321v134c0 74 5 147 11 163 14 37 47 72 84 89 40 19 119 12 153-13zm1120 0c62-46 67-62 70-224l3-149h-321v134c0 74 5 147 11 163 14 37 47 72 84 89 40 19 119 12 153-13zm-730-755-3-221-70-22c-38-12-101-36-139-53-38-18-70-32-72-32s8 24 21 53c43 91 29 178-42 257-95 106-236 108-338 5-78-77-95-166-52-260l23-50-34-35c-19-19-47-60-61-90-24-51-26-67-29-212l-4-158h-158v1040h960l-2-222zm1122-119v-340l-62 44c-35 24-94 61-133 82-38 21-71 39-72 40-1 0 4 19 12 40 30 85 13 163-52 235s-151 96-247 68c-78-23-166-135-166-212 0-13-12-16-74-16-40 0-94-3-120-6l-46-7v413h960v-341zm-1545-4c16-15 25-36 25-55s-9-40-25-55c-15-16-36-25-55-25s-40 9-55 25c-16 15-25 36-25 55s9 40 25 55c15 16 36 25 55 25s40-9 55-25zm1120 0c26-25 32-63 15-95-9-17-12-17-77-1-61 15-68 20-71 44-2 18 5 35 22 52 33 33 79 33 111 0zm-205-230c235-35 449-144 620-315 333-333 423-838 225-1258-62-131-127-224-225-322-439-438-1141-438-1580 0-255 255-372 614-315 965 57 352 277 655 594 819 213 110 443 148 681 111zm-930-75c0-5-4-10-9-10-4 0-49-39-100-86-89-84-91-85-91-56 0 63 38 123 95 148 35 16 105 18 105 4zm-434-565c-42-110-86-325-86-423v-42l-1002 2-1003 3-51 27c-76 40-107 70-144 140-32 60-34 69-38 186l-4 122h1167c1030 0 1166-2 1161-15zm-72-647c17-91 41-191 57-233 11-27 19-53 19-57 0-5-106-8-235-8-211 0-235 2-235 16 0 17 36 240 45 282 5 22 7 22 175 22s170 0 174-22zm213-539 52-79h-870l-24 25c-16 15-25 36-25 55s9 40 25 55l24 25 766-2 52-79z"/>
      <path d="m1346 4070c-63-16-153-70-197-117-22-24-55-74-72-111-29-61-32-76-32-162 0-82 4-103 27-153 15-32 42-77 60-100 18-22 28-42 22-44-37-12-147-87-202-138-162-148-232-327-232-591 0-119 1-126 25-149l24-25h1342l24 25c24 23 25 30 25 149 0 263-70 441-231 591-55 50-165 125-203 138-6 2 4 22 22 44 18 23 45 68 60 100 23 50 27 71 27 154 0 90-2 99-37 171-68 136-188 217-336 224-42 2-94-1-116-6zm168-162c86-26 166-136 166-228s-80-202-166-228c-94-28-169-8-239 63-102 101-102 229 0 330 70 71 145 90 239 63zm32-639c95-17 210-78 282-149 110-109 160-223 169-382l6-98h-1123v63c0 235 125 431 336 528 101 46 213 59 330 38z"/>
      <path d="m3305 2135-25-24v-1182l25-24c14-15 35-25 52-25 18 0 202 103 528 293 414 242 501 297 509 320 23 64 27 61-509 374-326 190-510 293-528 293-17 0-38-10-52-25zm530-425c171-99 310-185 310-190s-139-91-310-190c-170-100-329-192-352-206l-43-25v842l43-25c23-14 182-106 352-206z"/>
      </g>
      </svg>`,
      category: 'Basic',
      attributes: {
        title: 'Create Webinars'
      }
    });
    blockManager.add('table', {
      label: 'Table',
      content: '<table><tr><th><p>write row name</p></th><th><p>write row name</p><th></th><th><p>write row name</p></th></tr><tr><td><p>write row value</p></td><td><p>write row value</p></td><td><p>write row value</p></td></tr></table>',
      media:`<svg width="30px" height="30px" version="1.0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <g transform="translate(0 512) scale(.1 -.1)">
      <path d="m445 4899c-76-11-205-73-267-128-58-51-115-136-148-221l-25-65v-3850l25-65c33-85 90-170 148-221 72-63 192-117 287-130 53-6 771-9 2150-7l2070 3 65 23c81 30 188 100 235 155 46 53 87 127 111 197 18 53 19 125 19 1970s-1 1917-19 1970c-57 170-177 290-348 352l-63 23-2090 1c-1164 1-2117-2-2150-7zm4259-230c70-26 139-92 174-167l27-57 3-407 3-408h-4702l3 408c3 366 5 411 21 447 42 94 108 158 195 190 31 11 382 14 2129 14 2089 1 2092 1 2147-20zm-3424-1684v-425h-1070v850h1070v-425zm1170 0v-425h-960v850h960v-425zm1180 0v-425h-960v850h960v-425zm1280 0v-425h-1070v850h1070v-425zm-3630-1065v-430l-532 2-533 3-3 415c-1 228 0 421 3 427 3 10 120 13 535 13h530v-430zm1170 0v-430l-477 2-478 3-3 415c-1 228 0 421 3 427 3 10 109 13 480 13h475v-430zm1175 0v-425l-477-3-478-2v860l478-2 477-3v-425zm1280 0v-425l-532-3-533-2v860l533-2 532-3v-425zm-3625-1065v-426l-417 3-418 3-49 24c-66 33-122 91-155 160l-26 56-3 303-3 302h1071v-425zm1170 0v-425h-960v850h960v-425zm1180 0v-425h-960v850h960v-425zm1278 123-3-303-26-56c-33-69-89-127-155-160l-49-24-835-6v851h1072l-4-302z"/>
      </g>
      </svg>`,
      category: 'Basic',
      attributes: {
        title: 'Insert Blog',
        className: `fa fa-text`
      }
    });
    setEditor(editor);
  }, []);

  const savePage =()=>{  
    setHtml(editor.getHtml());
    setCss(editor.getCss());
    editor.runCommand('gjs-export-zip');
  }
 
  
    return(
        <div>
           <div id="editor"></div>
           <div className="toolbar" id="button">
             <a><Button variant="contained" color="primary" onClick={savePage}> Save</Button></a>
            </div>
        </div>
    )
}

export default Grapejs;